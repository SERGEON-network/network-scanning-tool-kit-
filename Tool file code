#!/usr/bin/env bash
# Master Network Scanning & Monitoring Toolkit
# For authorized security testing only

# Colors
RED="\033[0;31m"
GREEN="\033[0;32m"
YELLOW="\033[1;33m"
NC="\033[0m" # No Color

banner() {
    echo -e "${GREEN}"
    echo "========================================"
    echo "   Master Network Scanning Toolkit"
    echo "========================================"
    echo -e "${NC}"
}

menu() {
    echo -e "${YELLOW}Select an option:${NC}"
    echo "1) Host Discovery (nmap, arp-scan)"
    echo "2) Port Scanning (nmap, masscan)"
    echo "3) Service Enumeration"
    echo "4) Packet Capture (tcpdump, tshark)"
    echo "5) Bandwidth & Performance (iftop, iperf3)"
    echo "6) Wireless Recon (airodump, kismet)"
    echo "7) TLS/SSL Testing"
    echo "8) Exit"
    echo
}

host_discovery() {
    read -p "Enter subnet (e.g., 192.168.1.0/24): " SUBNET
    echo "[*] Nmap Ping Sweep..."
    nmap -sn $SUBNET
    echo "[*] ARP Scan..."
    sudo arp-scan -l
}

port_scanning() {
    read -p "Enter target IP/domain: " TARGET
    echo "[*] Nmap Full Scan..."
    nmap -sS -sV -O -A $TARGET -oN nmap_scan.txt
    echo "[*] Fast Masscan..."
    sudo masscan -p1-65535 $TARGET --rate 2000 -oG masscan.txt
}

service_enum() {
    read -p "Enter target IP: " TARGET
    echo "[*] Banner grabbing with netcat..."
    nc -nv $TARGET 80
    echo "[*] SMB Enumeration..."
    enum4linux $TARGET
    echo "[*] SNMP Walk..."
    snmpwalk -v2c -c public $TARGET
}

packet_capture() {
    read -p "Enter interface (e.g., eth0, wlan0): " IFACE
    echo "[*] Live capture (Ctrl+C to stop)..."
    sudo tcpdump -i $IFACE -nn
}

bandwidth_perf() {
    read -p "Enter interface (e.g., eth0): " IFACE
    echo "[*] Running iftop..."
    sudo iftop -i $IFACE
    echo "[*] iperf3 throughput test (server mode: run 'iperf3 -s' elsewhere)"
    read -p "Enter server IP: " SERVER
    iperf3 -c $SERVER -t 30
}

wireless_recon() {
    read -p "Enter wireless interface (e.g., wlan0): " WIFACE
    echo "[*] Starting monitor mode..."
    sudo airmon-ng start $WIFACE
    echo "[*] Capturing wireless packets..."
    sudo airodump-ng ${WIFACE}mon
}

tls_testing() {
    read -p "Enter domain: " DOMAIN
    echo "[*] OpenSSL certificate dump..."
    echo | openssl s_client -connect $DOMAIN:443 -servername $DOMAIN 2>/dev/null | openssl x509 -noout -text
    echo "[*] Nmap TLS cipher scan..."
    nmap --script ssl-enum-ciphers -p 443 $DOMAIN
}

# Main loop
while true; do
    banner
    menu
    read -p "Choice: " CHOICE
    case $CHOICE in
        1) host_discovery ;;
        2) port_scanning ;;
        3) service_enum ;;
        4) packet_capture ;;
        5) bandwidth_perf ;;
        6) wireless_recon ;;
        7) tls_testing ;;
        8) echo "Exiting..."; exit 0 ;;
        *) echo -e "${RED}Invalid choice!${NC}" ;;
    esac
    read -p "Press Enter to continue..."
done
